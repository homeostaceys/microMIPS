{% extends 'mips/extends/header.html' %}
{% load static %}
{% block extrahead %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/load.css' %}">
{% endblock %}
{% block script%}
    $(document).ready(function(){

        $('#editform').on("submit", function (event) {
                event.preventDefault();
                var data = new FormData(this);
                $.ajax({
                    url: "/editmem/",
                    method: "POST",
                    data: data,
                    async: false,
                    cache: false,
                    contentType: false,
                    enctype: 'multipart/form-data',
                    processData: false,
                    success: function (response) {
                        if ( response === "Success")
                            location.reload();
                    }
                });
        });
    });

    function editmem(  address, memval){
        $('#memadd').val(address);
        $('#memval').val(memval);
    }
{% endblock %}
{% block body %}

<div class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="editModal" id="editModal" aria-hidden="true">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <form action="#" method="GET" enctype="multipart/form-data" id="editform">
<div class="modal-header">
                <h2>Edit Memory</h2>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <div class="modal-body">

                    {% csrf_token %}
                    <label>Memory Content</label>
                    <input type="hidden" id="memadd" name="memadd" value="">
                    <input type="text" id="memval" class="form-control" name="memvalue" pattern="^([0-9A-Fa-f]{2})$"  size="2" maxlength="2" title="LENGTH OF A BYTE AND VALID HEX VAULES" required>

            </div>

            <div class="modal-footer">
                <button type="submit" class="btn btn-success" >Save</button>
            </div>
             </form>
        </div>
    </div>
</div>
<div class="container ml-lg-5">
  <div class="row ">
    <!--Opcode Table-->

        <div class="col  ml-lg-5 mr-lg-5">
            <h2 align="center"><strong class="text-white">Opcode Table</strong></h2>
            <table class="table table-bordered" style="table-layout: fixed;" >
                <thead>
                    <tr style="background-color: white; color: #111111;">
                        <th>Instruction</th>
                        <th>Opcode</th>
                    </tr>
                </thead>
                <tbody style="color: white;overflow-y: scroll; height: 30em; overflow: auto;">
                    {% for instr in instrclist %}
                    <tr>
                        <td>{{ instr.instruction }}</td>
                        <td>{{ instr.rep }}</td>
                    </tr>
                    {% endfor %}

                </tbody>

            </table>
      </div>
    <!--Memory Table-->
       <div class="col ml-lg-5 mr-lg-5">
            <h2  align="center"><strong class="text-white" >Memory Table</strong></h2>
            <table class="table table-bordered" >
                <thead>
                    <tr style="background-color: white; color: #111111;">
                        <th>Address</th>
                        <th>Content</th>
                    </tr>
                </thead>
                <tbody style="color: white; overflow: scroll; height: 30em; display:inline-block;">
                    {% for mem in mem1list %}

                    <tr>
                        <td><a role="button" onclick="editmem('{{ mem.address}}','{{ mem.memval }}');" class="btn btn-info btn-sm" data-toggle="modal" data-target="#editModal" >{{ mem.address }}</a></td>
                        <td >{{ mem.memval }}</td>
                    </tr>

                    {% endfor %}
                    {% for mem in mem2list %}

                    <tr>
                        <td>{{ mem.address }}</td>
                        <td >{{ mem.memval }}</td>
                    </tr>

                    {% endfor %}

                </tbody>

            </table>
        </div>



        <!--Register Table-->

        <div class=" ml-lg-5 col mr-lg-5">
            <h2 align="center"><strong class="text-white">Register Table</strong></h2>
            <table class="table table-bordered">
                <thead>
                    <tr style="background-color: white; color: #111111;display: block;">
                        <th  style="display: inline-block;">Register</th>
                        <th  style="display: inline-block;">Content</th>
                    </tr>
                </thead>
                <tbody style=" color: white;overflow-y: scroll; display: inline-block; height: 30em;">
                    {% for reg in reglist %}
                    <tr>
                        <td>R{{ reg.regnum }}</td>
                        <td>{{ reg.regval }}</td>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>
        </div>

  </div>
</div>
</div>

{% endblock %}